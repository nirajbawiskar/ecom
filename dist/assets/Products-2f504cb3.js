import{r as i,w as L,x as R,y as A,z as U,n as j,j as e,B as d,p as B}from"./index-17db9675.js";import{u as _,c as D,a as h}from"./index.esm-86351c04.js";import{C as H}from"./Container-49a8a690.js";import{S as I}from"./Spinner-64daf28a.js";import{C as f}from"./Card-c2d5f862.js";import{F as u}from"./FormControl-7c1b543c.js";import"./CardHeaderContext-18edfbd4.js";import"./index-a6d84f34.js";const K=()=>{const[C,g]=i.useState(!1),[o,m]=i.useState([]),[E,p]=i.useState([]),{data:P}=L(),[F,{isSuccess:y,isLoading:S}]=R(),[w,{isSuccess:b,isLoading:v}]=A(),[k,{isSuccess:N,isLoading:q}]=U(),[r,x]=i.useState(),a=_({enableReinitialize:!0,initialValues:{name:r?r.name:"",price:r?r.price:"",desc:r?r.desc:"",hero:r?r.hero:"",qty:r?r.qty:""},validationSchema:D({name:h().required("Enter name"),price:h().required("Enter price"),desc:h().required("Enter desc"),qty:h().required("Enter qty")}),onSubmit:(s,{resetForm:c})=>{if(r){const t=new FormData;for(const n in s)n!=="hero"&&t.append(n,s[n]);for(const n of o)t.append("remove",n);for(const n of s.hero)t.append("hero",n);k({_id:r._id,fd:t}),x(null),m([])}else{console.log(s);const t=new FormData;for(const n in s)n!=="hero"&&t.append(n,s[n]);for(const n of s.hero)t.append("hero",n);w(t)}p([]),c()}}),l=s=>B({"form-control my-2":!0,"is-invalid":a.touched[s]&&a.errors[s],"is-valid":a.touched[s]&&!a.errors[s]});return i.useEffect(()=>{b&&j.success("Product create success")},[b]),i.useEffect(()=>{y&&j.success("Product delete success")},[y]),i.useEffect(()=>{N&&j.success("Product delete success")},[N]),e.jsxs(H,{children:[v||S||q?e.jsxs(e.Fragment,{children:["Please wait....",e.jsx(I,{})]}):e.jsxs(f,{className:"mb-5",children:[e.jsx(f.Header,{children:"Product"}),e.jsx(f.Body,{children:e.jsxs("form",{onSubmit:a.handleSubmit,children:[e.jsx(u,{type:"text",placeholder:"Enter Product name",className:l("name"),...a.getFieldProps("name")}),e.jsx(u,{type:"number",placeholder:"Enter Product Price",className:l("price"),...a.getFieldProps("price")}),e.jsx(u,{type:"text",placeholder:"Enter Prodcut desc",className:l("desc"),...a.getFieldProps("desc")}),e.jsx(u,{type:"number",placeholder:"Enter Product qty",className:l("qty"),...a.getFieldProps("qty")}),r?e.jsxs(e.Fragment,{children:[r.hero.map(s=>e.jsx("div",{children:e.jsxs("div",{className:`${o.includes(s)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4`,children:[e.jsx("img",{src:s,height:50,className:"me-2 rounded-3",alt:""}),o.includes(s)?e.jsx(d,{onClick:c=>m(o.filter(t=>t!==s)),variant:"dark",children:"cancel"}):e.jsx(d,{variant:"danger",onClick:c=>{o.includes(s)||m([...o,s])},children:"Remove"})]})})),C?e.jsxs(e.Fragment,{children:[e.jsx(u,{type:"file",multiple:!0,onChange:s=>{const c=[];for(const t of s.target.files)c.push(URL.createObjectURL(t));a.setFieldValue("hero",s.target.files),p(c)},className:l("hero"),placeholder:"Enter Product hero"}),e.jsx(d,{onClick:s=>g(!1),variant:"dark",children:"Cancel"})]}):e.jsx(d,{onClick:s=>g(!0),className:"my-3",children:"Add New Image"})]}):e.jsx(e.Fragment,{children:e.jsx(u,{type:"file",multiple:!0,onChange:s=>{const c=[];for(const t of s.target.files)c.push(URL.createObjectURL(t));a.setFieldValue("hero",s.target.files),p(c)},className:l("hero"),placeholder:"Enter Product hero"})}),E.map(s=>e.jsx("img",{src:s,height:50,alt:""})),r?e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"submit",variant:"warning",className:"w-100 btn-lg",children:"Update Product"}),e.jsx(d,{type:"button",onClick:s=>x(null),variant:"outline-dark",className:"w-100 btn-lg",children:"cancel"})]}):e.jsx(d,{type:"submit",className:"w-100 btn-lg",children:"Add Product"})]})})]}),e.jsxs("table",{class:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"gty"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:P&&P.result.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.desc}),e.jsx("td",{children:s.price}),e.jsx("td",{children:s.qty}),e.jsx("td",{children:s.hero.map(c=>e.jsx("img",{src:c,height:50,className:"mx-2 rounded"}))}),e.jsxs("td",{children:[e.jsx(d,{onClick:c=>x(s),className:"me-2",variant:"warning",children:"Edit"}),e.jsx(d,{onClick:c=>F(s._id),className:"me-2",variant:"danger",children:"Remove"})]})]},s._id))})]})]})};export{K as default};
